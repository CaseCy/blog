<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://casecy.github.io').hostname,
    root: '/',
    scheme: 'Mist',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":false,"style":"flat"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="A Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Me">
<meta property="og:url" content="https://casecy.github.io/page/5/index.html">
<meta property="og:site_name" content="Me">
<meta property="og:description" content="A Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="C.c">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://casecy.github.io/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>Me</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Me</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E9%98%9F%E5%88%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E9%98%9F%E5%88%97/" class="post-title-link" itemprop="url"> Java线程池和队列		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 09:33:52" itemprop="dateCreated datePublished" datetime="2018-10-19T09:33:52+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82/" itemprop="url" rel="index">
                    <span itemprop="name">杂</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参考：<br><a target="_blank" rel="noopener" href="http://www.cnblogs.com/kuoAT/p/6714762.html">Java ThreadPool</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/superfj/p/7544971.html">由浅入深理解Java线程池及线程池的如何使用</a></p>
<hr>
<h2 id="线程池规则"><a href="#线程池规则" class="headerlink" title="线程池规则"></a>线程池规则</h2><p>线程池的线程执行规则跟任务队列有很大的关系。</p>
<p>下面都假设任务队列没有大小限制：</p>
<ul>
<li>如果线程数量&lt;=核心线程数量，那么直接启动一个核心线程来执行任务，不会放入队列中。</li>
<li>如果线程数量&gt;核心线程数，但&lt;=最大线程数，并且任务队列是LinkedBlockingDeque的时候，超过核心线程数量   的任务会放在任务队列中排队。</li>
<li>如果线程数量&gt;核心线程数，但&lt;=最大线程数，并且任务队列是SynchronousQueue的时候，线程池会创建新线程   执行任务，这些任务也不会被放在任务队列中。这些线程属于非核心线程，在任务完成后，闲置时间达到了超时时间就会被清除。</li>
<li>如果线程数量&gt;核心线程数，并且&gt;最大线程数，当任务队列是LinkedBlockingDeque，会将超过核心线程的任务   放在任务队列中排队。也就是当任务队列是LinkedBlockingDeque并且没有大小限制时，线程池的最大线程数设   置是无效的，他的线程数最多不会超过核心线程数。</li>
<li>如果线程数量&gt;核心线程数，并且&gt;最大线程数，当任务队列是SynchronousQueue的时候，会因为线程池拒绝添加   任务而抛出异常。</li>
</ul>
<p>任务队列大小有限时</p>
<ul>
<li>当LinkedBlockingDeque塞满时，新增的任务会直接创建新线程来执行，当创建的线程数量超过最大线程数量时会抛异常。</li>
<li>SynchronousQueue没有数量限制。因为他根本不保持这些任务，而是直接交给线程池去执行。当任务数量超过最大线程数时会直接抛异常。</li>
</ul>
<hr>
<h2 id="任务缓存队列"><a href="#任务缓存队列" class="headerlink" title="任务缓存队列"></a>任务缓存队列</h2><p>在前面我们多次提到了任务缓存队列，即workQueue，它用来存放等待执行的任务。</p>
<p>workQueue的类型为BlockingQueue<Runnable>，通常可以取下面三种类型：</p>
<ul>
<li><p>有界任务队列ArrayBlockingQueue：基于数组的先进先出队列，此队列创建时必须指定大小；</p>
</li>
<li><p>无界任务队列LinkedBlockingQueue：基于链表的先进先出队列，如果创建时没有指定此队列大小，则默认为Integer.MAX_VALUE；</p>
</li>
<li><p>直接提交队列synchronousQueue：这个队列比较特殊，它不会保存提交的任务，而是将直接新建一个线程来执行新来的任务</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/linux/" class="post-title-link" itemprop="url">Linux</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 09:31:48" itemprop="dateCreated datePublished" datetime="2018-10-19T09:31:48+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>引用：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/hafiz/p/6686187.html">Linux知识整理</a></p>
<hr>
<h2 id="各文件夹的作用"><a href="#各文件夹的作用" class="headerlink" title="各文件夹的作用"></a>各文件夹的作用</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1)<span class="string">./</span>             所有其他目录的最顶级根目录</span><br><span class="line">　　　　2)<span class="string">./home</span>    系统用户的家目录，每个用户在该文件夹下有一个与登录名同名的目录作为该用户的家目录，但是root用户的家目录就在根目录下。</span><br><span class="line">　　　　3)<span class="string">./root</span>　　root用户的家目录</span><br><span class="line">　　　　4)<span class="string">./boot</span>     系统内核和开机必须文件所在目录</span><br><span class="line">　　　　5)<span class="string">./etc</span>       系统配置文件所在目录</span><br><span class="line">　　　　6)<span class="string">./dev</span>      系统所有设备文件所在的目录</span><br><span class="line">　　　　7)<span class="string">./usr</span><span class="params">(unix system resource)</span> 保存程序的相关文件</span><br><span class="line">　　　　8)<span class="string">./tmp</span>      临时文件所在的目录</span><br><span class="line">　　　　9)<span class="string">./var</span>　　 主要放置系统执行过程中经常变化的文件，例如缓存（cache）或者是随时更改的登录文件（log file）</span><br><span class="line">　　　　10)<span class="string">./opt</span>　  用于存储第三方软件的目录，不过我们还是习惯放在<span class="string">/usr/local</span>下</span><br><span class="line">　　　　11)<span class="string">./bin</span>、<span class="string">/usr/bin</span>        常用的可执行指令文件目录</span><br><span class="line">　　　　12)<span class="string">./sbin</span>    root用户才有权限执行的指令</span><br><span class="line">　　　　13)<span class="string">./lib</span>、<span class="string">/usr/lib</span>、<span class="string">/usr/local/lib</span>    系统可复用类库目录</span><br><span class="line">　　　　14)<span class="string">./mnt</span>、<span class="string">/media</span>        外部设备的mountpoint,当检测到设备接入时会自动产生挂载点</span><br><span class="line">　　　　15)<span class="string">./lost</span>+found        每个分区都会创建一个该目录，用户系统异常时恢复丢失的东西</span><br><span class="line">　　　　16)<span class="string">./proc</span>        系统进程以及网络状态信息目录，在内存中</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/jsp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/jsp/" class="post-title-link" itemprop="url"> JSP		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:51:00" itemprop="dateCreated datePublished" datetime="2018-10-19T08:51:00+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/front/" itemprop="url" rel="index">
                    <span itemprop="name">front</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参考：<a target="_blank" rel="noopener" href="https://www.runoob.com/jsp/jsp-syntax.html">菜鸟教程</a></p>
<hr>
<h2 id="脚本程序"><a href="#脚本程序" class="headerlink" title="脚本程序"></a>脚本程序</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% 代码片段 %&gt;</span><br></pre></td></tr></table></figure>
<p>示例代码</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;Hello World&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">Hello World!&lt;br/&gt;</span><br><span class="line">&lt;%</span><br><span class="line">out.println(<span class="string">&quot;Your IP address is &quot;</span> + request.getRemoteAddr());</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>中文编码</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br></pre></td></tr></table></figure>
<p>注：脚本程序中不能包含任何的文本，HTML标签，和JSP元素，如if写法</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (day == <span class="number">1</span> | day == <span class="number">7</span>) &#123; %&gt;</span><br><span class="line">      &lt;p&gt;今天是周末&lt;/p&gt;</span><br><span class="line">&lt;% &#125; <span class="keyword">else</span> &#123; %&gt;</span><br><span class="line">      &lt;p&gt;今天不是周末&lt;/p&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>
<h2 id="JSP声明"><a href="#JSP声明" class="headerlink" title="JSP声明"></a>JSP声明</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! declaration; [ declaration; ]+ ... %&gt;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> initVar=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> serviceVar=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> destroyVar=<span class="number">0</span>;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jspInit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        initVar++;</span><br><span class="line">        System.out.println(<span class="string">&quot;jspInit(): JSP被初始化了&quot;</span>+initVar+<span class="string">&quot;次&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jspDestroy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        destroyVar++;</span><br><span class="line">        System.out.println(<span class="string">&quot;jspDestroy(): JSP被销毁了&quot;</span>+destroyVar+<span class="string">&quot;次&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    serviceVar++;</span><br><span class="line">    System.out.println(<span class="string">&quot;_jspService(): JSP共响应了&quot;</span>+serviceVar+<span class="string">&quot;次请求&quot;</span>);</span><br><span class="line"></span><br><span class="line">    String content1=<span class="string">&quot;初始化次数 : &quot;</span>+initVar;</span><br><span class="line">    String content2=<span class="string">&quot;响应客户请求次数 : &quot;</span>+serviceVar;</span><br><span class="line">    String content3=<span class="string">&quot;销毁次数 : &quot;</span>+destroyVar;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<h2 id="JSP注释方式及其含义"><a href="#JSP注释方式及其含义" class="headerlink" title="JSP注释方式及其含义"></a>JSP注释方式及其含义</h2><p><img src="http://imageu.oss-cn-shenzhen.aliyuncs.com/noteimage/jsp%E6%B3%A8%E9%87%8A%E8%AF%AD%E6%B3%95.png" alt="注释"><br>##JSP表达式</p>
<blockquote>
<p>一个JSP表达式中包含的脚本语言表达式，先被转化成String，然后插入到表达式出现的地方。<br>由于表达式的值会被转化成String，所以您可以在一个文本行中使用表达式而不用去管它是否是HTML标签。<br>表达式元素中可以包含任何符合Java语言规范的表达式，但是不能使用分号来结束表达式。</p>
</blockquote>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= 表达式 %&gt;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">今天的日期是: &lt;%= (<span class="keyword">new</span> java.util.Date()).toLocaleString()%&gt;</span><br></pre></td></tr></table></figure>
<h2 id="JSP的内置对象"><a href="#JSP的内置对象" class="headerlink" title="JSP的内置对象"></a>JSP的内置对象</h2><p><img src="http://imageu.oss-cn-shenzhen.aliyuncs.com/noteimage/jsp%E9%9A%90%E5%90%AB%E5%AF%B9%E8%B1%A1.png" alt=""><br>注：使用的时候要放在代码块中执行</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/%E4%BD%BF%E7%94%A8jekins%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%EF%BC%88war%E5%8C%85%E6%96%B9%E5%BC%8F%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/%E4%BD%BF%E7%94%A8jekins%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%EF%BC%88war%E5%8C%85%E6%96%B9%E5%BC%8F%EF%BC%89/" class="post-title-link" itemprop="url"> 使用jekins部署项目（war包方式）		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:49:04" itemprop="dateCreated datePublished" datetime="2018-10-19T08:49:04+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://jenkins.io/">Jenkins官网</a></p>
<hr>
<h2 id="启动Jekins"><a href="#启动Jekins" class="headerlink" title="启动Jekins"></a>启动Jekins</h2><p>到Jenkins官网下载war包，可以直接通过jar包启动，默认端口是8080，war包中自带jetty，可以通过下面方式修改启动的端口</p>
<pre><code>java -jar jenkins.war --httpPort=8020</code></pre><p>也可以将war包放到tomcat下启动</p>
<h2 id="登录Jekins"><a href="#登录Jekins" class="headerlink" title="登录Jekins"></a>登录Jekins</h2><p>第一次启动的时，Jenkins会自动生成一个密码，在日志文件中，这个密码作为默认账号admin的默认密码，参考<br><a target="_blank" rel="noopener" href="https://jenkins.io/doc/book/installing/">Jekins官方文档中war包部分</a>，如果没有看到，可以在当前用户文件夹下的<code>.jenkins\secrets</code>下的<code>initialAdminPassword</code>这个文件中查找到（注windows和linux一样，linux中<code>.jenkins</code>可能是隐藏的）</p>
<h2 id="使用Jenkins构建项目-maven"><a href="#使用Jenkins构建项目-maven" class="headerlink" title="使用Jenkins构建项目(maven)"></a>使用Jenkins构建项目(maven)</h2><h3 id="构建准备"><a href="#构建准备" class="headerlink" title="构建准备"></a>构建准备</h3><p>因为是maven项目，所以要在安装jekin的系统中安装git(如果是git)，maven，jdk并把他们的位置配置到</p>
<pre><code>系统管理---全局工具配置(Globel tools)--将对于工具的路径配置进去，自动配置暂时不知道什么用，点了没效果</code></pre><p><img src="http://imageu.oss-cn-shenzhen.aliyuncs.com/jenkins/%E5%85%A8%E5%B1%80%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE.png" alt="全局工具配置"><br>工具配置好了之后还要准备一些插件<br>Maven Integration plugin 用于构建maven项目<br>Git plugin git的插件<br>通过</p>
<pre><code>系统管理---插件管理---可选插件</code></pre><p>搜索安装，已安装忽略此步</p>
<h3 id="构建配置"><a href="#构建配置" class="headerlink" title="构建配置"></a>构建配置</h3><p>以上步骤准备好之后</p>
<pre><code>新建---输入项目名---构建一个maven项目</code></pre><h4 id="源码管理"><a href="#源码管理" class="headerlink" title="源码管理"></a>源码管理</h4><p>这里以git项目构建，svn类似<br>源码管理部分选择git,填入git的地址，填入之后，会自动测试，如果是报类似无法使用xxx命令，一般是git没装好（注：无法使用https也是，这种把git删了，重新完整的安装之后就可以了），如果提示没有权限<br>点击下面Credentials旁的add添加身份认证信息，如果有可以直接选，都正确情况下就不会存在红字。</p>
<h4 id="build"><a href="#build" class="headerlink" title="build"></a>build</h4><p>Goals and options 填入maven构建的命令即可，如clean package</p>
<h4 id="Post-Steps"><a href="#Post-Steps" class="headerlink" title="Post Steps"></a>Post Steps</h4><p>这里可以选择构建成功后执行的操作，上面有几个选项，表示执行的时间</p>
<pre><code>Run only if build succeeds 构建成功时执行
Run only if build succeeds or is unstable 构建成功或者不稳定时执行
Run regardless of build result 不管构建结果如何都执行</code></pre><p>add选项中第一个选项是用在windows系统中执行命令的，第二个是用在linux中执行shell命令的，可以将执行的命令单独写在一个可执行文件中，如windos的bat，linux的sh文件（执行前记得先给文件授权(<code>chmod 777 文件</code>)），在这里填写执行命令<br><img src="http://imageu.oss-cn-shenzhen.aliyuncs.com/jenkins/postSteps.png" alt="s"></p>
<h4 id="开始构建"><a href="#开始构建" class="headerlink" title="开始构建"></a>开始构建</h4><p>配置好之后点击保存,可以在my views中查看新建的项目，点击立即构建，就可以开始构建项目了，点击左边<br><code>构建执行状态</code>下的进度条，可以查看输出的控制台信息</p>
<h2 id="设置构建邮件通知"><a href="#设置构建邮件通知" class="headerlink" title="设置构建邮件通知"></a>设置构建邮件通知</h2><p>用于构建过程中的邮件通知（成功失败都会通知）</p>
<h3 id="设置发送邮箱信息"><a href="#设置发送邮箱信息" class="headerlink" title="设置发送邮箱信息"></a>设置发送邮箱信息</h3><p>操作之前，要安装一些邮件的插件（一般在安装Jenkins的时候都会安装，如果勾选的话），具体百度</p>
<pre><code>系统管理---系统设置---邮件通知</code></pre><p>填写stmp邮件服务器，如163邮箱的<code>smtp.163.com</code>每个邮件服务器的stmp不同，这个可以在网上查找，另外要实现用stmp服务，要先在对应的邮箱中开启stmp服务并设置密码，填写好之后点击高级，填写开启stmp服务的账户名和密码，最好勾选ssl协议，有些邮箱不用ssl协议不会通过，端口和用户默认后缀可以不填。<br>填写好之后，可以勾选<code>通过发送测试邮件测试配置</code>，填写发送的邮箱来测试填写的内容是否正确。</p>
<h3 id="项目中设置要发送的邮箱"><a href="#项目中设置要发送的邮箱" class="headerlink" title="项目中设置要发送的邮箱"></a>项目中设置要发送的邮箱</h3><p>设置需要发送邮件的项目在<code>构建设置</code>中勾选<code>E-mail Notification</code>下面有几个错误的情况通知，根据情况自己选择，填入需要发送的邮箱就可以了</p>
<h2 id="远程构建"><a href="#远程构建" class="headerlink" title="远程构建"></a>远程构建</h2><h3 id="构建前配置"><a href="#构建前配置" class="headerlink" title="构建前配置"></a>构建前配置</h3><p>可以参考：<a target="_blank" rel="noopener" href="http://blog.csdn.net/russ44/article/details/51694074">使用shell脚本部署到远程服务器</a><br>在可选插件中安装<code>publish over ssh</code>插件，安装之后打开系统设置<br>在publish over ssh部分，展开高级选项配置ssh server</p>
<pre><code>Name 这里可以随便填写
HostName 填写要连接的服务器ip或者名称
UserName 要登录的用户
Remote Directory 远程服务器文件目录
勾选 Use password authentication, or use a different key
Passphrase / Password 填写上方用户名的密码</code></pre><p>其他部分可以不管，具体可以自行研究</p>
<h3 id="项目设置"><a href="#项目设置" class="headerlink" title="项目设置"></a>项目设置</h3><p>在项目设置的构建环境处勾选</p>
<pre><code>Send files or execute commands over SSH after the build runs
//在构建之后发送文件或执行命令</code></pre><p>点击add Transfers</p>
<pre><code>Source files 要拷贝的文件，这里是可以填相对路径(相对于项目的位置，如target/*.war)，也可以填绝对路径
Remove prefix 移除前缀 可以不填
Remote directory 远程目录，如果填相对的路径是相对于之前系统设置中的路径的
Exec command 要执行的命令，高版本Jenkins会要求填，但是可以不管</code></pre><p>配置好之后保存，重新构建下就可以了</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>linux构建时tomcat启动随jenkin执行命令的结束而停止，导致tomcat启动不成功解决方法在执行的shell命令前加入</p>
<pre><code>export BUILD_ID=aaaa
//BUILD_ID为任意值</code></pre><p>构建最后报错<br>Maven JVM terminated unexpectedly with exit code 137<br>原因：<a target="_blank" rel="noopener" href="http://blog.csdn.net/mzh1992/article/details/62432330">http://blog.csdn.net/mzh1992/article/details/62432330</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/%E4%BD%BF%E7%94%A8jedis%E8%BF%9E%E6%8E%A5redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/%E4%BD%BF%E7%94%A8jedis%E8%BF%9E%E6%8E%A5redis/" class="post-title-link" itemprop="url"> 使用Jedis连接Redis		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:47:33" itemprop="dateCreated datePublished" datetime="2018-10-19T08:47:33+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如果是通过外网访问Redis一定要开放防火墙的端口权限，不然不能访问<br>导入pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">6379</span>);      <span class="comment">//新建一个到指定ip和端口的Jedis对象</span></span><br><span class="line">jedis.set(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;这是一个测试&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>创建对象还有一些其他方法，这里不赘述</p>
<hr>
<h2 id="通过JedisPool连接"><a href="#通过JedisPool连接" class="headerlink" title="通过JedisPool连接"></a>通过JedisPool连接</h2><p>设置JedisPool，参照<a target="_blank" rel="noopener" href="http://www.cnblogs.com/tankaixiong/p/4048167.html">JedisPoolConfig配置</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">JedisPoolConfig config = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line"> </span><br><span class="line"><span class="comment">//连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true</span></span><br><span class="line">config.setBlockWhenExhausted(<span class="keyword">true</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//设置的逐出策略类名, 默认DefaultEvictionPolicy(当连接超过最大空闲时间,或连接数超过最大空闲连接数)</span></span><br><span class="line">config.setEvictionPolicyClassName(<span class="string">&quot;org.apache.commons.pool2.impl.DefaultEvictionPolicy&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//是否启用pool的jmx管理功能, 默认true</span></span><br><span class="line">config.setJmxEnabled(<span class="keyword">true</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//MBean ObjectName = new ObjectName(&quot;org.apache.commons.pool2:type=GenericObjectPool,name=&quot; + &quot;pool&quot; + i); 默 认为&quot;pool&quot;, JMX不熟,具体不知道是干啥的...默认就好.</span></span><br><span class="line">config.setJmxNamePrefix(<span class="string">&quot;pool&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//是否启用后进先出, 默认true</span></span><br><span class="line">config.setLifo(<span class="keyword">true</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//最大空闲连接数, 默认8个</span></span><br><span class="line">config.setMaxIdle(<span class="number">8</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//最大连接数, 默认8个</span></span><br><span class="line">config.setMaxTotal(<span class="number">8</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//获取连接时的最大等待毫秒数(如果设置为阻塞时BlockWhenExhausted),如果超时就抛异常, 小于零:阻塞不确定的时间,  默认-1</span></span><br><span class="line">config.setMaxWaitMillis(-<span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//逐出连接的最小空闲时间 默认1800000毫秒(30分钟)</span></span><br><span class="line">config.setMinEvictableIdleTimeMillis(<span class="number">1800000</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//最小空闲连接数, 默认0</span></span><br><span class="line">config.setMinIdle(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//每次逐出检查时 逐出的最大数目 如果为负数就是 : 1/abs(n), 默认3</span></span><br><span class="line">config.setNumTestsPerEvictionRun(<span class="number">3</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//对象空闲多久后逐出, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲数 时直接逐出,不再根据MinEvictableIdleTimeMillis判断  (默认逐出策略)   </span></span><br><span class="line">config.setSoftMinEvictableIdleTimeMillis(<span class="number">1800000</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//在获取连接的时候检查有效性, 默认false</span></span><br><span class="line">config.setTestOnBorrow(<span class="keyword">false</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//在空闲时检查有效性, 默认false</span></span><br><span class="line">config.setTestWhileIdle(<span class="keyword">false</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1</span></span><br><span class="line">config.setTimeBetweenEvictionRunsMillis(-<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p>注：Jedis低版本可能不存在<code>maxTotal</code>和<code>maxWaitMillis</code>，使用<code>maxActive</code>和<code>maxWait</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">JedisPoolConfig jedisPoolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        jedisPoolConfig.setMaxIdle(<span class="number">5</span>);      <span class="comment">//设置最大空闲数</span></span><br><span class="line">        jedisPoolConfig.setBlockWhenExhausted(<span class="keyword">true</span>);    <span class="comment">//设置连接耗尽时是否阻塞，true为阻塞到超时（默认），false抛出异常</span></span><br><span class="line">        jedisPoolConfig.setEvictionPolicyClassName(<span class="string">&quot;org.apache.commons.pool2.impl.DefaultEvictionPolicy&quot;</span>);<span class="comment">//设置逐出策略</span></span><br><span class="line">        jedisPoolConfig.setJmxEnabled(<span class="keyword">true</span>);        <span class="comment">//是否启用pool的jmx</span></span><br><span class="line">        jedisPoolConfig.setMinIdle(<span class="number">2</span>);      <span class="comment">//初始化连接数</span></span><br><span class="line">        jedisPoolConfig.setMaxWaitMillis(<span class="number">3000</span>);<span class="comment">//设置资源耗尽时最大阻塞时间</span></span><br><span class="line">        JedisPool jedisPool = <span class="keyword">new</span> JedisPool(jedisPoolConfig,<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">6379</span>,<span class="number">3000</span>);</span><br><span class="line">        Jedis jedis = jedisPool.getResource();</span><br><span class="line">        String aa = jedis.get(<span class="string">&quot;aa&quot;</span>);</span><br><span class="line">        System.out.println(aa);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Jedis集成Spring"><a href="#Jedis集成Spring" class="headerlink" title="Jedis集成Spring"></a>Jedis集成Spring</h2><p>配置文件加载</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:config/redis.properties&quot;</span> <span class="attr">ignore-unresolvable</span>=<span class="string">&quot;true&quot;</span> <span class="attr">file-encoding</span>=<span class="string">&quot;utf-8&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置jedispoolconfig--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jedisPoolConfig&quot;</span> <span class="attr">class</span>=<span class="string">&quot;redis.clients.jedis.JedisPoolConfig&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.minIdle&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lifo&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.lifo&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.maxIdle&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxTotal&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.maxTotal&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxWaitMillis&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.maxWaitMillis&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minEvictableIdleTimeMillis&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.minEvictableIdleTimeMillis&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;numTestsPerEvictionRun&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.numTestsPerEvictionRun&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;softMinEvictableIdleTimeMillis&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.softMinEvictableIdleTimeMillis&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;testOnBorrow&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.testOnBorrow&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;testWhileIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.testWhileIdle&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;timeBetweenEvictionRunsMillis&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.timeBetweenEvictionRunsMillis&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;blockWhenExhausted&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.blockWhenExhausted&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jmxEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.jmxEnabled&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置jedispool--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jedisPool&quot;</span> <span class="attr">class</span>=<span class="string">&quot;redis.clients.jedis.JedisPool&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;jedisPoolConfig&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.address&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jedis.port&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;int&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">type</span>=<span class="string">&quot;int&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>通过上面的方式，使用<code>@Autowired</code>注入的时候会自动注入<code>jedispool</code>并且使用配置文件中的配置<br>redis.properties:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置初始化实例数</span></span><br><span class="line"><span class="meta">jedis.minIdle</span>=<span class="string">1</span></span><br><span class="line"><span class="comment">#设置最大空闲数</span></span><br><span class="line"><span class="meta">jedis.maxIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment">#设置进出策略，默认为true,LIFO（后进先出）false为FIFO</span></span><br><span class="line"><span class="meta">jedis.lifo</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#设置最大连接数</span></span><br><span class="line"><span class="meta">jedis.maxTotal</span>=<span class="string">10</span></span><br><span class="line"><span class="comment">#连接耗尽时。最大等待时间</span></span><br><span class="line"><span class="meta">jedis.maxWaitMillis</span>=<span class="string">3000</span></span><br><span class="line"><span class="comment">#逐出连接的最小空闲时间 默认1800000毫秒(30分钟)</span></span><br><span class="line"><span class="meta">jedis.minEvictableIdleTimeMillis</span>=<span class="string">1800000</span></span><br><span class="line"><span class="comment">#每次逐出检查时 逐出的最大数目 如果为负数就是 : 1/abs(n), 默认3</span></span><br><span class="line"><span class="meta">jedis.numTestsPerEvictionRun</span>=<span class="string">3</span></span><br><span class="line"><span class="comment">#对象空闲多久后逐出, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲数 时直接逐出,不再根据MinEvictableIdleTimeMillis判断  (默认逐出策略)</span></span><br><span class="line"><span class="meta">jedis.softMinEvictableIdleTimeMillis</span>=<span class="string">1800000</span></span><br><span class="line"><span class="comment">#在获取连接的时候检查有效性, 默认false</span></span><br><span class="line"><span class="meta">jedis.testOnBorrow</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#在空闲时检查有效性, 默认false</span></span><br><span class="line"><span class="meta">jedis.testWhileIdle</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1</span></span><br><span class="line"><span class="meta">jedis.timeBetweenEvictionRunsMillis</span>=<span class="string">1000</span></span><br><span class="line"><span class="comment">#连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true</span></span><br><span class="line"><span class="meta">jedis.blockWhenExhausted</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#是否启用pool的jmx管理功能, 默认true</span></span><br><span class="line"><span class="meta">jedis.jmxEnabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">######################JedisPool################################</span></span><br><span class="line"><span class="meta">jedis.address</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="meta">jedis.port</span>=<span class="string">6379</span></span><br></pre></td></tr></table></figure>
<p>上面设置只能为参考，不具有实际项目的应用能力<br><br><br>Java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> JedisPool jedisPool;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Jedis jedis = jedisPool.getResource();</span><br><span class="line">        <span class="keyword">return</span> jedis.get(key);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">       log.error(<span class="string">&quot;get Error!&quot;</span>+e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可以只注入JedisPoolConfig，手动创建JedisPool</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisUtil</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JedisPoolConfig jedisPoolConfig;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> JedisPool jedisPool;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jedis.address&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String redisAddress;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jedis.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> redisPort;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Log log = LogFactory.getLog(JedisUtil.class);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//单例</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> JedisPool <span class="title">getPool</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (jedisPool==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (JedisUtil.class)&#123;</span><br><span class="line">                <span class="keyword">if</span> (jedisPool==<span class="keyword">null</span>)&#123;</span><br><span class="line">                    jedisPool = <span class="keyword">new</span> JedisPool(jedisPoolConfig,redisAddress,redisPort);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> jedisPool;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Jedis jedis = getPool().getResource();</span><br><span class="line">            <span class="keyword">return</span> jedis.get(key);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            log.error(<span class="string">&quot;get Error&quot;</span>+e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/jdk8-stream-api/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/jdk8-stream-api/" class="post-title-link" itemprop="url"> JDK8 Stream API		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:46:21" itemprop="dateCreated datePublished" datetime="2018-10-19T08:46:21+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82/" itemprop="url" rel="index">
                    <span itemprop="name">杂</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参考：<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/CarpenterLee/p/6545321.html">Java Stream API入门篇</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/chaoer89/article/details/52389458">Java8 Stream API介绍</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c53eb31752c4">Java8之Stream类</a></p>
<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;ga&quot;</span>, <span class="string">&quot;dsagafd&quot;</span>,<span class="string">&quot;adfsafdsa&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;d&quot;</span>);</span><br><span class="line">strings.stream().filter(e-&gt;e.startsWith(<span class="string">&quot;a&quot;</span>)).forEach(e-&gt; System.out.println(e));</span><br><span class="line">System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line">strings.stream().distinct().forEach(e-&gt; System.out.println(e));</span><br><span class="line">Stream&lt;String&gt; sorted = strings.stream().sorted((a, b) -&gt; b.length() - a.length());</span><br><span class="line">System.out.println(<span class="string">&quot;==================&quot;</span>);</span><br><span class="line">sorted.forEach(a-&gt; System.out.println(a));</span><br><span class="line"><span class="keyword">boolean</span> a = strings.stream().anyMatch((s) -&gt; s.equals(<span class="string">&quot;a&quot;</span>));</span><br><span class="line"><span class="keyword">boolean</span> b = strings.stream().allMatch((s) -&gt; s.equals(<span class="string">&quot;a&quot;</span>));</span><br><span class="line"><span class="keyword">boolean</span> c = strings.stream().noneMatch((s) -&gt; s.equals(<span class="string">&quot;a&quot;</span>));</span><br><span class="line">System.out.println(a);</span><br><span class="line">System.out.println(b);</span><br><span class="line">System.out.println(c);</span><br><span class="line">---------------------结果--------------------------</span><br><span class="line">a</span><br><span class="line">adfsafdsa</span><br><span class="line">a</span><br><span class="line">-------------------</span><br><span class="line">a</span><br><span class="line">d</span><br><span class="line">ga</span><br><span class="line">dsagafd</span><br><span class="line">adfsafdsa</span><br><span class="line">==================</span><br><span class="line">adfsafdsa</span><br><span class="line">dsagafd</span><br><span class="line">ga</span><br><span class="line">a</span><br><span class="line">d</span><br><span class="line">a</span><br><span class="line">d</span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">false</span></span><br></pre></td></tr></table></figure>
<p>对stream的操作分为为两类，中间操作(intermediate operations)和结束操作(terminal operations)<br>中间操作是惰性化的，每次调用会对Stream做一定的处理，返回一个新的Stream，并没有真正开始计算<br>每个stream只能有一个结束操作，执行了结束操作之后，stream就被消费掉了。</p>
<p>常用方法：<br>中间操作：<code>concat() distinct() filter() flatMap() limit() map() peek() 
skip() sorted() parallel() sequential() unordered()</code><br>结束操作：<code>allMatch() anyMatch() collect() count() findAny() findFirst() 
forEach() forEachOrdered() max() min() noneMatch() reduce() toArray()</code></p>
<p><code>sort()</code>有两种方式，对stream进行排序，默认排序和自定义的Comparable形式，例子参见上方<br><code>map</code>和<code>flatMap</code> 都是对stream进行遍历操作，都会返回操作之后的stream，不同的是flatMap会将多个集合中的元素全部拿出来放到一个集合中，而map不会<br>如对两个集合[1,2,3],[8,9,7]<br>stream之后的map操作的结果是[1,2,3],[8,9,7]<br>stream之后的flatMap结果是[1,2,3,8,9,7]<br><code>filter</code>可以对元素进行过滤，参考上面例子<br><code>limit</code>截取stream中的元素<br><code>skip</code>跳过stream中的元素<br><code>distinct</code>去重，通过equals和hashcode方法，自定义类<br><code>anyMatch</code>,<code>allMatch</code>,<code>noneMatch</code>,stream中的元素有匹配，全部匹配，全都不匹配。<br><code>reduce</code>聚合操作</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/%E5%9C%A8linux%E4%B8%8A%E5%AE%89%E8%A3%85redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/%E5%9C%A8linux%E4%B8%8A%E5%AE%89%E8%A3%85redis/" class="post-title-link" itemprop="url"> 在Linux上安装Redis		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:43:45" itemprop="dateCreated datePublished" datetime="2018-10-19T08:43:45+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>引用：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/dongfanghao/p/7158282.html">Redis1</a> <a target="_blank" rel="noopener" href="http://blog.csdn.net/ludonqin/article/details/47211109">Redis2</a></p>
<hr>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装C语言的编译环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc</span><br></pre></td></tr></table></figure>

<p>下载Redis的安装包<a target="_blank" rel="noopener" href="https://redis.io/download">Redis</a><br>放到<code>/usr/local/src</code>下面<br>解压缩</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf redis-3.2.9.tar.gz</span><br></pre></td></tr></table></figure>
<p>到解压后的目录<code>/usr/local/src/redis-3.2.9</code><br>编译打包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure>
<p>常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">make     　　　　　　　　　　// 编译redis</span><br><span class="line">make distclean　　   　　// 清除之前编译过程中残留的文件等,可在make前执行</span><br><span class="line">redis-server       // 默认启动redis服务器</span><br><span class="line">redis-server redis.conf    // 使用配置文件启动redis服务器</span><br></pre></td></tr></table></figure>

<p>跳转到<code>src</code>目录执行,也可以手动拷贝redis-server、redis-cli、redis-check-aof、redis-check-dump等至/usr/local/bin目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>跳转到<code>/usr/local/bin</code>下，会多出下面的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@centos bin]<span class="comment"># ll</span></span><br><span class="line">总用量 26348</span><br><span class="line">-rwxr-xr-x. 1 root root 5580423  redis-benchmark</span><br><span class="line">-rwxr-xr-x. 1 root root   22185  redis-check-aof</span><br><span class="line">-rwxr-xr-x. 1 root root 7830146  redis-check-rdb</span><br><span class="line">-rwxr-xr-x. 1 root root 5709355  redis-cli</span><br><span class="line">lrwxrwxrwx. 1 root root      12  redis-sentinel -&gt; redis-server</span><br><span class="line">-rwxr-xr-x. 1 root root 7830146  redis-server</span><br></pre></td></tr></table></figure>

<h2 id="redis-conf"><a href="#redis-conf" class="headerlink" title="redis.conf"></a>redis.conf</h2><p>在<code>/usr/local/src</code>下面建一个redis文件夹，用来存放配置文件和一些其他信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir redis //创建redis文件夹</span><br><span class="line">cp ../redis-3.2.9/redis.conf . //将redis.conf复制到当前目录</span><br><span class="line">vi redis.conf</span><br></pre></td></tr></table></figure>
<p>打开redis.conf设置</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">`bind <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>`</span><br><span class="line">protected-mode <span class="keyword">yes</span></span><br><span class="line">`port <span class="number">6379</span>`</span><br><span class="line">tcp-backlog <span class="number">511</span></span><br><span class="line">timeout <span class="number">0</span></span><br><span class="line">tcp-keepalive <span class="number">300</span></span><br><span class="line">`daemonize <span class="keyword">yes</span>`</span><br><span class="line">supervised <span class="keyword">no</span></span><br><span class="line">`pidfile /var/run/redis_6379.pid`</span><br><span class="line">loglevel notice</span><br><span class="line">`logfile ./redis.<span class="built_in">log</span>`</span><br><span class="line">databases <span class="number">16</span></span><br><span class="line">save <span class="number">900</span> <span class="number">1</span></span><br><span class="line">save <span class="number">300</span> <span class="number">10</span></span><br><span class="line">save <span class="number">60</span> <span class="number">10000</span></span><br><span class="line">stop-writes-on-bgsave-error <span class="keyword">yes</span></span><br><span class="line">rdbcompression <span class="keyword">yes</span></span><br><span class="line">rdbchecksum <span class="keyword">yes</span></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line">`dir ./`</span><br><span class="line">slave-serve-stale-data <span class="keyword">yes</span></span><br><span class="line">slave-read-only <span class="keyword">yes</span></span><br><span class="line">repl-diskless-sync <span class="keyword">no</span></span><br><span class="line">repl-diskless-sync-delay <span class="number">5</span></span><br><span class="line">repl-disable-tcp-nodelay <span class="keyword">no</span></span><br><span class="line">slave-priority <span class="number">100</span></span><br><span class="line">`appendonly <span class="keyword">yes</span>`</span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"><span class="keyword">no</span>-appendfsync-on-rewrite <span class="keyword">no</span></span><br><span class="line">auto-aof-rewrite-percentage <span class="number">100</span></span><br><span class="line">auto-aof-rewrite-<span class="built_in">min</span>-size <span class="number">64</span>mb</span><br><span class="line">aof-load-truncated <span class="keyword">yes</span></span><br><span class="line">lua-time-limit <span class="number">5000</span></span><br><span class="line">slowlog-<span class="built_in">log</span>-slower-than <span class="number">10000</span></span><br><span class="line">slowlog-<span class="built_in">max</span>-len <span class="number">128</span></span><br><span class="line">latency-monitor-threshold <span class="number">0</span></span><br><span class="line">notify-keyspace-events <span class="string">&quot;&quot;</span></span><br><span class="line">hash-<span class="built_in">max</span>-ziplist-entries <span class="number">512</span></span><br><span class="line">hash-<span class="built_in">max</span>-ziplist-value <span class="number">64</span></span><br><span class="line">list-<span class="built_in">max</span>-ziplist-size <span class="number">-2</span></span><br><span class="line">list-compress-depth <span class="number">0</span></span><br><span class="line"><span class="keyword">set</span>-max-intset-entries <span class="comment">512</span></span><br><span class="line">zset-max-ziplist-entries <span class="comment">128</span></span><br><span class="line">zset-max-ziplist-value <span class="comment">64</span></span><br><span class="line">hll-sparse-max-bytes <span class="comment">3000</span></span><br><span class="line">activerehashing <span class="comment">yes</span></span><br><span class="line">client-output-buffer-limit <span class="comment">normal 0 0 0</span></span><br><span class="line">client-output-buffer-limit <span class="comment">slave 256mb 64mb 60</span></span><br><span class="line">client-output-buffer-limit <span class="comment">pubsub 32mb 8mb 60</span></span><br><span class="line">hz <span class="comment">10</span></span><br><span class="line">aof-rewrite-incremental-fsync <span class="comment">yes</span></span><br></pre></td></tr></table></figure>
<p>几个常用的设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span> 127.0.0.1  //访问ip，0.0.0.0 表示任何人都可以访问</span><br><span class="line">port 6379 //默认的端口</span><br><span class="line">daemonize yes //运行模式，yes表示后台运行 no表示Console运行</span><br><span class="line">pidfile /var/run/redis_6379.pid 进程文件</span><br><span class="line">logfile ./redis.log  //<span class="built_in">log</span>文件</span><br><span class="line">appendonly yes //是否持久化，yes会在当前目录生成文件</span><br></pre></td></tr></table></figure>
<p>使用<code>i</code>编辑，<code>/</code>查找内容，<code>:wq</code>保存并退出 <code>:q!</code>不保存退出<code>n</code>查找下一个</p>
<h2 id="启动和关闭"><a href="#启动和关闭" class="headerlink" title="启动和关闭"></a>启动和关闭</h2><p>使用配置文件启动<br>可以在新建的redis目录里执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server redis.conf</span><br></pre></td></tr></table></figure>
<p>使用客户端连接redis</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br></pre></td></tr></table></figure>
<p>退出客户端</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+c</span><br></pre></td></tr></table></figure>

<p>关闭redis</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-cli shutdown</span><br><span class="line"><span class="comment">#带密码的关闭(带密码连接一样，修改后面命令即可)</span></span><br><span class="line">redis-cli -a 密码 shutdown</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -ef |grep redis</span><br><span class="line"><span class="built_in">kill</span> -9 pid</span><br></pre></td></tr></table></figure>
<h2 id="配置Redis服务"><a href="#配置Redis服务" class="headerlink" title="配置Redis服务"></a>配置Redis服务</h2><p>创建redis启动脚本<br>拷贝解压包下utils下redis启动脚本至<code>/etc/init.d/</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp redis_init_script /etc/init.d/</span><br></pre></td></tr></table></figure>
<p>修改脚本名称(也可不修改)为redis_6379</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv redis_init_script redis_6379</span><br><span class="line"></span><br><span class="line">vi redis_6379</span><br></pre></td></tr></table></figure>
<p>将对应的参数修改</p>
<pre><code>REDISPORT=6379
EXEC=/usr/local/bin/redis-server
CLIEXEC=/usr/local/bin/redis-cli

PIDFILE=/var/run/redis_$&#123;REDISPORT&#125;.pid</code></pre><p>CONF=”/usr/local/src/redis/redis_${REDISPORT}.conf”</p>
<p>启动/关闭/重启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/redis_6379 start/stop/restart</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service redis_6379 start/stop/restart</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Redis的常用命令"><a href="#Redis的常用命令" class="headerlink" title="Redis的常用命令"></a>Redis的常用命令</h2><p>参考：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/whoamme/p/3532129.html">Redis常用命令</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -p 6379  //客户端连接指定端口</span><br></pre></td></tr></table></figure>
<p>返回值说明。默认返回<code>(integer) 0</code>表示false，即失败，返回<code>(integer) 1</code>表示true，即成功<br>字符串：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> key value</span><br><span class="line">get key value</span><br><span class="line">setnx key value  //如果key存在就不设置，如果不存在就设置，</span><br><span class="line">mset key value key value...     //同时设置多个值，同时成功，同时失败</span><br><span class="line">msetnx key value key value...</span><br><span class="line">mget key1 key2 key3     //获取多个Key的值</span><br><span class="line">getset key newvalue     //获取key并设置为新值</span><br><span class="line">append key word         //给key追加word中的内容</span><br><span class="line">setrange key n repvalue    //将key对应value的第n个字符和这里的repvalue替换(从0开始)</span><br><span class="line">getrange key start end  //获取key的值从start到end</span><br><span class="line">strlen key      //返回key对应value值的长度</span><br></pre></td></tr></table></figure>

<p>key-value</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">keys *      //列出所有的键值</span><br><span class="line">rename key new key  //重命名键值</span><br><span class="line"><span class="built_in">type</span> key    //判断key的类型</span><br><span class="line">exists key  //判断key是否存在</span><br><span class="line">del key     //删除key</span><br><span class="line">expire key second   //设置key的过期时间，单位为秒</span><br><span class="line">ttl key         //查看key的过期时间 -2为已过期 -1为没有设置过期</span><br><span class="line">persist key     //取消过期时间设置</span><br><span class="line">randomkey 随机返回一个key</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/apache-pool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/apache-pool/" class="post-title-link" itemprop="url"> Apache Pool		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:41:36" itemprop="dateCreated datePublished" datetime="2018-10-19T08:41:36+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82/" itemprop="url" rel="index">
                    <span itemprop="name">杂</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>tags： Apache pool 对象池 引用：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/jinzhiming/p/5120670.html">对象池，包括带key的</a></p>
<hr>
<p>导入pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--commons pool--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-pool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>注：这里的pool不是pool2</p>
<hr>
<h2 id="不带key的对象池"><a href="#不带key的对象池" class="headerlink" title="不带key的对象池"></a>不带key的对象池</h2><p>概述： 　　factory对象实现<code>PoolableObjectFactory</code>接口，完成其中的方法，可以在调用实例中将factory对象通过构造方法放入<code>GenericObjectPool</code>或者<code>StackObjectPool</code> 测试对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PoolTestObject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//记录次数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> num;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> active;</span><br><span class="line">    <span class="comment">//对象id</span></span><br><span class="line">    <span class="keyword">private</span> String uuid;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PoolTestObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.uuid = UUID.randomUUID().toString();</span><br><span class="line">        System.out.println(<span class="string">&quot;create a Object UUID:&quot;</span>+ uuid);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//略去getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>不带key的poolFactory</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PoolTestFactory</span> <span class="keyword">implements</span> <span class="title">PoolableObjectFactory</span>&lt;<span class="title">PoolTestObject</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PoolTestObject <span class="title">makeObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PoolTestObject testPoolObject = <span class="keyword">new</span> PoolTestObject();</span><br><span class="line">        System.out.println(<span class="string">&quot;创建对象,uuid:&quot;</span>+testPoolObject.getUuid());</span><br><span class="line">        <span class="keyword">return</span> testPoolObject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyObject</span><span class="params">(PoolTestObject testPoolObject)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        testPoolObject = <span class="keyword">null</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;摧毁对象！,uuid:&quot;</span>+testPoolObject.getUuid());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<p>​    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">validateObject</span><span class="params">(PoolTestObject testPoolObject)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;验证对象！,uuid:&quot;</span>+testPoolObject.getUuid());</span><br><span class="line">        <span class="comment">//验证实例是否安全</span></span><br><span class="line">        <span class="keyword">if</span> (testPoolObject.isActive())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重新初始化实例返回池</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">activateObject</span><span class="params">(PoolTestObject testPoolObject)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        testPoolObject.setActive(<span class="keyword">true</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;激活对象！uuid:&quot;</span>+testPoolObject.getUuid());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//取消初始化实例返回到空闲对象池</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">passivateObject</span><span class="params">(PoolTestObject testPoolObject)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        testPoolObject.setActive(<span class="keyword">false</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;钝化对象 uuid:&quot;</span>+testPoolObject.getUuid());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>验证(使用的引用中的例子，并做了点修改)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPool</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PoolTestObject bo = <span class="keyword">null</span>;</span><br><span class="line">        PoolableObjectFactory factory = <span class="keyword">new</span> PoolTestFactory();</span><br><span class="line">        GenericObjectPool pool = <span class="keyword">new</span> GenericObjectPool(factory);</span><br><span class="line">        GenericObjectPool.Config config = <span class="keyword">new</span> GenericObjectPool.Config();<span class="comment">//连接池配置</span></span><br><span class="line">        config.maxActive = <span class="number">5</span>;</span><br><span class="line">        pool.setConfig(config);<span class="comment">//设置连接池</span></span><br><span class="line">        <span class="comment">//这里两种池都可以</span></span><br><span class="line">        <span class="comment">//ObjectPool pool = new StackObjectPool(factory);</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;\n===========&quot;</span>+i+<span class="string">&quot;===========&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;池中处于闲置状态的实例pool.getNumIdle()：&quot;</span>+pool.getNumIdle());<span class="comment">//拿到闲置状态的链接数</span></span><br><span class="line">                <span class="comment">//从池里取一个对象，新创建makeObject或将以前闲置的对象取出来</span></span><br><span class="line">                bo = (PoolTestObject)pool.borrowObject();</span><br><span class="line">                System.out.println(bo.getUuid());</span><br><span class="line">                bo.setUuid(<span class="string">&quot;-----------------------------------------1&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;bo:&quot;</span>+bo);</span><br><span class="line">                System.out.println(bo.getNum());;</span><br><span class="line">                System.out.println(<span class="string">&quot;池中所有在用实例数量pool.getNumActive()：&quot;</span>+pool.getNumActive());</span><br><span class="line">                <span class="keyword">if</span>((i%<span class="number">2</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">//用完之后归还对象</span></span><br><span class="line">                    pool.returnObject(bo);</span><br><span class="line">                    System.out.println(<span class="string">&quot;归还对象！！！！&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(bo != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    pool.returnObject(bo);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//关闭池</span></span><br><span class="line">                pool.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<p>调用结果，可以看到factory中的各个方法的执行过程,以及返回的对象如果做了修改，会保存这个修改，归还了对象之后，这个对象会回到池中作为空闲对象，下次borrow的时候，如果有空闲对象，会先调用空闲对象，如果没有空闲对象了，会调用<code>makeObject</code>去自动创建对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">===========<span class="number">0</span>===========</span><br><span class="line">池中处于闲置状态的实例pool.getNumIdle()：<span class="number">0</span></span><br><span class="line">create a Object UUID:04ef2118-0b83-458c-b8e9-dc6d4b6548f8</span><br><span class="line">创建对象,uuid:04ef2118-0b83-458c-b8e9-dc6d4b6548f8</span><br><span class="line">激活对象！uuid:04ef2118-0b83-458c-b8e9-dc6d4b6548f8</span><br><span class="line">04ef2118-0b83-458c-b8e9-dc6d4b6548f8</span><br><span class="line">bo:cn.ws.apachepool.PoolTestObject@3d012ddd</span><br><span class="line"><span class="number">0</span></span><br><span class="line">池中所有在用实例数量pool.getNumActive()：<span class="number">1</span></span><br><span class="line">钝化对象 uuid:-----------------------------------------<span class="number">1</span></span><br><span class="line">归还对象！！！！</span><br><span class="line"></span><br><span class="line">===========<span class="number">1</span>===========</span><br><span class="line">池中处于闲置状态的实例pool.getNumIdle()：<span class="number">1</span></span><br><span class="line">激活对象！uuid:-----------------------------------------<span class="number">1</span></span><br><span class="line">-----------------------------------------<span class="number">1</span></span><br><span class="line">bo:cn.ws.apachepool.PoolTestObject@3d012ddd</span><br><span class="line"><span class="number">0</span></span><br><span class="line">池中所有在用实例数量pool.getNumActive()：<span class="number">1</span></span><br><span class="line"></span><br><span class="line">===========<span class="number">2</span>===========</span><br><span class="line">池中处于闲置状态的实例pool.getNumIdle()：<span class="number">0</span></span><br><span class="line">create a Object UUID:d979744b-fa76-<span class="number">4547</span>-a34d-<span class="number">432e75049249</span></span><br><span class="line">创建对象,uuid:d979744b-fa76-<span class="number">4547</span>-a34d-<span class="number">432e75049249</span></span><br><span class="line">激活对象！uuid:d979744b-fa76-<span class="number">4547</span>-a34d-<span class="number">432e75049249</span></span><br><span class="line">d979744b-fa76-<span class="number">4547</span>-a34d-<span class="number">432e75049249</span></span><br><span class="line">bo:cn.ws.apachepool.PoolTestObject@6f2b958e</span><br><span class="line"><span class="number">0</span></span><br><span class="line">池中所有在用实例数量pool.getNumActive()：<span class="number">2</span></span><br><span class="line">钝化对象 uuid:-----------------------------------------<span class="number">1</span></span><br><span class="line">归还对象！！！！</span><br><span class="line"></span><br><span class="line">===========<span class="number">3</span>===========</span><br><span class="line">池中处于闲置状态的实例pool.getNumIdle()：<span class="number">1</span></span><br><span class="line">激活对象！uuid:-----------------------------------------<span class="number">1</span></span><br><span class="line">-----------------------------------------<span class="number">1</span></span><br><span class="line">bo:cn.ws.apachepool.PoolTestObject@6f2b958e</span><br><span class="line"><span class="number">0</span></span><br><span class="line">池中所有在用实例数量pool.getNumActive()：<span class="number">2</span></span><br><span class="line"></span><br><span class="line">===========<span class="number">4</span>===========</span><br><span class="line">池中处于闲置状态的实例pool.getNumIdle()：<span class="number">0</span></span><br><span class="line">create a Object UUID:34bf5dce-<span class="number">6449</span>-439c-ac92-5d26557d37b9</span><br><span class="line">创建对象,uuid:34bf5dce-<span class="number">6449</span>-439c-ac92-5d26557d37b9</span><br><span class="line">激活对象！uuid:34bf5dce-<span class="number">6449</span>-439c-ac92-5d26557d37b9</span><br><span class="line">34bf5dce-<span class="number">6449</span>-439c-ac92-5d26557d37b9</span><br><span class="line">bo:cn.ws.apachepool.PoolTestObject@1eb44e46</span><br><span class="line"><span class="number">0</span></span><br><span class="line">池中所有在用实例数量pool.getNumActive()：<span class="number">3</span></span><br><span class="line">钝化对象 uuid:-----------------------------------------<span class="number">1</span></span><br><span class="line">归还对象！！！！</span><br><span class="line">钝化对象 uuid:-----------------------------------------<span class="number">1</span></span><br></pre></td></tr></table></figure>


<p><code>GenericObjectPool</code>可以在创建了之后设置<code>Cofig</code>可以查看设置的源码 具体参数如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfig</span><span class="params">(GenericObjectPool.Config conf)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.setMaxIdle(conf.maxIdle); </span><br><span class="line">            <span class="keyword">this</span>.setMinIdle(conf.minIdle);  </span><br><span class="line">            <span class="keyword">this</span>.setMaxActive(conf.maxActive); <span class="comment">//能借出的最大值，为负数表示没限制</span></span><br><span class="line">            <span class="keyword">this</span>.setMaxWait(conf.maxWait);  <span class="comment">//最大等待时间</span></span><br><span class="line">            <span class="keyword">this</span>.setWhenExhaustedAction(conf.whenExhaustedAction);<span class="comment">//借出对象达到最大值时的行为</span></span><br><span class="line">            <span class="keyword">this</span>.setTestOnBorrow(conf.testOnBorrow);    <span class="comment">//设定在借出对象时是否进行有效性检查</span></span><br><span class="line">            <span class="keyword">this</span>.setTestOnReturn(conf.testOnReturn);    <span class="comment">//设定在还回对象时是否进行有效性检查</span></span><br><span class="line">            <span class="keyword">this</span>.setTestWhileIdle(conf.testWhileIdle);  <span class="comment">//设定在进行后台对象清理时，是否还对没有过期的池内对象进行有效性检查。不能通过有效性检查的对象也将被回收</span></span><br><span class="line">            <span class="keyword">this</span>.setNumTestsPerEvictionRun(conf.numTestsPerEvictionRun);</span><br><span class="line">            <span class="keyword">this</span>.setMinEvictableIdleTimeMillis(conf.minEvictableIdleTimeMillis);    <span class="comment">//设定在进行后台对象清理时，视休眠时间超过了多少毫秒的对象为过期。过期的对象将被回收。如果这个值不是正数，那么对休眠时间没有特别的约束。</span></span><br><span class="line">            <span class="keyword">this</span>.setTimeBetweenEvictionRunsMillis(conf.timeBetweenEvictionRunsMillis);  <span class="comment">//设定间隔每过多少毫秒进行一次后台对象清理的行动。如果这个值不是正数，则实际上不会进行后台对象清理。</span></span><br><span class="line">            <span class="keyword">this</span>.setSoftMinEvictableIdleTimeMillis(conf.softMinEvictableIdleTimeMillis);</span><br><span class="line">            <span class="keyword">this</span>.setLifo(conf.lifo);    <span class="comment">//池对象的放入和取出默认是后进先出的原则，默认是true，代表后进后出，设置为false代表先进先出。</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>


<blockquote>
<p>参数whenExhaustedA ction指定在池中借出对象的数目已达极限的情况下，调用它的borrowObject方法时的行为。可以选用的值有：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GenericObjectPool.WHEN_EXHAUSTED_BLOCK，表示等待；</span><br><span class="line">GenericObjectPool.WHEN_EXHAUSTED_GROW，表示创建新的实例（不过这就使maxActive参数失去了意义）；</span><br><span class="line">GenericObjectPool.WHEN_EXHAUSTED_FAIL，表示抛出一个java.util.NoSuchElementException异常。</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="带key的对象池"><a href="#带key的对象池" class="headerlink" title="带key的对象池"></a>带key的对象池</h2><p>概述：factory对象实现<code>KeyedPoolableObjectFactory</code>接口，完成其中的方法，可以在调用实例中将factory对象通过构造方法放入<code>GenericKeyedObjectPool</code> 可以通过<code>keyPool.addObject(&quot;name&quot;);</code>往池中添加对象，也可以直接通过<code>keyPool.borrow(&quot;name&quot;);</code>如果没有，会自动创建一个再借出来 带key的对象池和不带key的对象池区别在于可以通过key去取到特定的对象(在添加对象的时候回去设置key)，具体参考<a target="_blank" rel="noopener" href="http://www.cnblogs.com/jinzhiming/p/5120670.html">引用</a></p>
<hr>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>还可以实现<code>ObjectPool</code>接口，完成其中的方法，来自己定义一个Pool，这里的<code>GenericObjectPool</code>就是实现了<code>ObjectPool</code>接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ObjectPool</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">T <span class="title">borrowObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception, NoSuchElementException, IllegalStateException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">returnObject</span><span class="params">(T var1)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">invalidateObject</span><span class="params">(T var1)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception, IllegalStateException, UnsupportedOperationException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getNumIdle</span><span class="params">()</span> <span class="keyword">throws</span> UnsupportedOperationException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getNumActive</span><span class="params">()</span> <span class="keyword">throws</span> UnsupportedOperationException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> <span class="keyword">throws</span> Exception, UnsupportedOperationException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** <span class="doctag">@deprecated</span> */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setFactory</span><span class="params">(PoolableObjectFactory&lt;T&gt; var1)</span> <span class="keyword">throws</span> IllegalStateException, UnsupportedOperationException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/transactional%E6%A0%87%E7%AD%BE%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/transactional%E6%A0%87%E7%AD%BE%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7/" class="post-title-link" itemprop="url">@Transactional标签的事务特性</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:39:14" itemprop="dateCreated datePublished" datetime="2018-10-19T08:39:14+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Transactional标签的事务特性"><a href="#Transactional标签的事务特性" class="headerlink" title="@Transactional标签的事务特性"></a>@Transactional标签的事务特性</h1><h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><h2 id="事务传播方式"><a href="#事务传播方式" class="headerlink" title="事务传播方式"></a>事务传播方式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation=Propagation.REQUIRED)</span></span><br></pre></td></tr></table></figure>
<p>默认的方式：如果有事务, 那么加入事务, 没有的话新建一个</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation=Propagation.NOT_SUPPORTED)</span></span><br></pre></td></tr></table></figure>
<p>容器不为这个方法开启事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation=Propagation.REQUIRES_NEW)</span></span><br></pre></td></tr></table></figure>
<p>不管是否存在事务,都创建一个新的事务,原来的挂起,新的执行完毕,继续执行老的事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation=Propagation.MANDATORY)</span> </span><br></pre></td></tr></table></figure>
<p>必须在一个已有的事务中执行,否则抛出异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation=Propagation.NEVER)</span> </span><br></pre></td></tr></table></figure>
<p>必须在一个没有的事务中执行,否则抛出异常(与Propagation.MANDATORY相反)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation=Propagation.SUPPORTS)</span> </span><br></pre></td></tr></table></figure>
<p>如果其他bean调用这个方法,在其他bean中声明事务,那就用事务.如果其他bean没有声明事务,那就不用事务</p>
<h2 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(isolation = Isolation.READ_UNCOMMITTED)</span></span><br></pre></td></tr></table></figure>
<p>读取未提交数据(会出现脏读, 不可重复读) 基本不使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(isolation = Isolation.READ_COMMITTED)</span></span><br></pre></td></tr></table></figure>
<p>读取已提交数据(会出现不可重复读和幻读)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(isolation = Isolation.REPEATABLE_READ)</span></span><br></pre></td></tr></table></figure>
<p>可重复读(会出现幻读)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(isolation = Isolation.SERIALIZABLE)</span></span><br></pre></td></tr></table></figure>
<h2 id="标签中的常用属性"><a href="#标签中的常用属性" class="headerlink" title="标签中的常用属性"></a>标签中的常用属性</h2><ul>
<li>readOnly<br>  该属性用于设置当前事务是否为只读事务，设置为true表示只读，false则表示可读写，默认值为false。例如：<code>@Transactional(readOnly=true)</code></li>
<li>rollbackFor<br> 该属性用于设置需要进行回滚的异常类数组，当方法中抛出指定异常数组中的异常时，则进行事务回滚。例如：<br> 指定单一异常类：<code>@Transactional(rollbackFor=RuntimeException.class)</code><br> 指定多个异常类：<code>@Transactional(rollbackFor=&#123;RuntimeException.class, Exception.class&#125;)</code></li>
<li>rollbackForClassName<br> 该属性用于设置需要进行回滚的异常类名称数组，当方法中抛出指定异常名称数组中的异常时，则进行事务回滚。例如：<br> 指定单一异常类名称：<code>@Transactional(rollbackForClassName=&quot;RuntimeException&quot;)</code><br> 指定多个异常类名称：<code>@Transactional(rollbackForClassName=&#123;&quot;RuntimeException&quot;,&quot;Exception&quot;&#125;)</code></li>
<li>propagation<br> 该属性用于设置事务的传播行为<br> 例如：<code>@Transactional(propagation=Propagation.NOT_SUPPORTED,readOnly=true)</code></li>
</ul>
<h2 id="Attention"><a href="#Attention" class="headerlink" title="Attention:"></a>Attention:</h2><p>@Transactional使用的时候同一个类的不同方法不会有事务的传播，不同的类会有事务的传播，比如</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Class Test&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">A</span><span class="params">()</span></span>&#123;</span><br><span class="line">        B(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">B</span><span class="params">(String word)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        System.out.println(word);</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在A中调用B当B中发生异常的时候，这里不会出现回滚，因为这个时候A不具有事务特性，在同一个类中的不同方法上不具有事务的传播特性</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://casecy.github.io/2018/10/19/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="C.c">
      <meta itemprop="description" content="A Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Me">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/19/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3/" class="post-title-link" itemprop="url"> 自定义注解		</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-10-19 08:36:36" itemprop="dateCreated datePublished" datetime="2018-10-19T08:36:36+08:00">2018-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-06 19:16:16" itemprop="dateModified" datetime="2021-07-06T19:16:16+08:00">2021-07-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9D%82/" itemprop="url" rel="index">
                    <span itemprop="name">杂</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/xd502djj/archive/2012/07/26/2610040.html">引用1</a><br><a target="_blank" rel="noopener" href="http://www.cnblogs.com/peida/archive/2013/04/24/3036689.html">引用2</a></p>
<hr>
<h2 id="元注解"><a href="#元注解" class="headerlink" title="元注解"></a>元注解</h2><p>注解的注解(给其他注解打注解的注解)<br>有四种：@Target，@Retention，@Documented，@Inherited</p>
<ul>
<li><code>@Target</code>：<br> 概述：用于指定注解的使用位置<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">ElementType.CONSTRUCTOR:</span>用于描述构造器</span><br><span class="line"><span class="symbol">ElementType.FIELD:</span>用于描述域</span><br><span class="line"><span class="symbol">ElementType.LOCAL_VARIABLE:</span>用于描述局部变量</span><br><span class="line"><span class="symbol">ElementType.METHOD:</span>用于描述方法</span><br><span class="line"><span class="symbol">ElementType.PACKAGE:</span>用于描述包</span><br><span class="line"><span class="symbol">ElementType.PARAMETER:</span>用于描述参数</span><br><span class="line"><span class="symbol">ElementType.TYPE:</span>用于描述类、接口(包括注解类型) 或enum声明</span><br></pre></td></tr></table></figure>
使用如下，表明这个注解只能在方法和类接口等上使用<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD,ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AccessCheck &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li><code>@Retention</code>：<br> 概述：注解存在的地方<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RetentionPolicy.SOURCE  <span class="regexp">//</span>只存在于源码中，不被编译到Class文件中</span><br><span class="line">RetentionPolicy.CLASS  <span class="regexp">//</span>可以编译到Class文件中，但是不能再运行时被获取（默认）</span><br><span class="line">RetentionPolicy.RUNTIME  <span class="regexp">//</span>可以编译到Class文件中，可以在运行时通过反射获取</span><br></pre></td></tr></table></figure>
使用如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AccessCheck &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li><code>@Documented</code>：<br> 概述：这个注解是否可以被包含在javaDoc中，打了这个注解表示可以包含<br> 使用如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AccessCheck &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li><p><code>@Inherited</code>：<br>  概述：说明子类可以继承父类中的该注解</p>
<blockquote>
<p>@Inherited 元注解是一个标记注解，@Inherited阐述了某个被标注的类型是被继承的。如果一个使用了@Inherited修饰的annotation类型被用于一个class，则这个annotation将被用于该class的子类。</p>
</blockquote>
<blockquote>
<p>注意：@Inherited annotation类型是被标注过的class的子类所继承。类并不从它所实现的接口继承annotation，方法并不从它所重载的方法继承annotation。</p>
</blockquote>
<blockquote>
<p>当@Inherited annotation类型标注的annotation的Retention是RetentionPolicy.RUNTIME，则反射API增强了这种继承性。如果我们使用java.lang.reflect去查询一个@Inherited annotation类型的annotation时，反射代码检查将展开工作：检查class和其父类，直到发现指定的annotation类型被发现，或者到达类继承结构的顶层。</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="自定义注解"><a href="#自定义注解" class="headerlink" title="自定义注解"></a>自定义注解</h2><blockquote>
<p>使用@interface自定义注解时，自动继承了java.lang.annotation.Annotation接口，由编译程序自动完成其他细节。在定义注解时，不能继承其他的注解或接口。@interface用来声明一个注解，其中的每一个方法实际上是声明了一个配置参数。方法的名称就是参数的名称，返回值类型就是参数的类型（返回值类型只能是基本类型、Class、String、enum）。可以通过default来声明参数的默认值。</p>
</blockquote>
<p>注意：<br>　　第一,只能用public或默认(default)这两个访问权修饰.例如,Stringvalue();这里把方法设为defaul默认类型；　 　<br>　　第二,参数成员只能用基本类型byte,short,char,int,long,float,double,boolean八种基本数据类型和 String,Enum,Class,annotations等数据类型,以及这一些类型的数组.例如,String value();这里的参数成员就为String;　　<br>　　第三,如果只有一个参数成员,最好把参数名称设为”value”,后加小括号.例:下面的例子FruitName注解就只有一个参数成员。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AccessCheck &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;  <span class="comment">//参数</span></span><br><span class="line">    <span class="function">String <span class="title">level</span><span class="params">()</span> <span class="keyword">default</span> &quot;1&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="自定义注解使用"><a href="#自定义注解使用" class="headerlink" title="自定义注解使用"></a>自定义注解使用</h3><p>通过反射机制操作自定义注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    AppResult a = <span class="keyword">new</span> AppResult();</span><br><span class="line">    Field[] fields = a.getClass().getDeclaredFields();<span class="comment">//拿到私有的字段</span></span><br><span class="line">    <span class="keyword">int</span> modifiers = a.getClass().getModifiers();</span><br><span class="line">    System.out.println(modifiers);</span><br><span class="line">    <span class="keyword">for</span> (Field field : fields)&#123;</span><br><span class="line">        AccessCheck annotation = field.getAnnotation(AccessCheck.class);</span><br><span class="line">        System.out.println(field.getModifiers());;</span><br><span class="line">        System.out.println(field.getName()); <span class="comment">//获取字段名</span></span><br><span class="line">        <span class="keyword">if</span> (annotation!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (annotation.level().equals(<span class="string">&quot;1&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Class&lt;?&gt; type = field.getType();    <span class="comment">//获取字段类型</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;是否相等：&quot;</span>+type.equals(String.class)); <span class="comment">//这个字段为String,输出为true</span></span><br><span class="line">                    field.setAccessible(<span class="keyword">true</span>);  <span class="comment">//允许访问私有字段</span></span><br><span class="line">                    System.out.println(field.get(a)); <span class="comment">//拿到a对象中f字段的值</span></span><br><span class="line">                    field.set(a, <span class="string">&quot;zasjfdals&quot;</span>);              <span class="comment">//设置a对象中f字段的值</span></span><br><span class="line">                    System.out.println(field.get(a));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">C.c</p>
  <div class="site-description" itemprop="description">A Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/CaseCy" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CaseCy" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://liquidcat.cc/" title="Blog → https:&#x2F;&#x2F;liquidcat.cc" rel="noopener" target="_blank"><i class="fa fa-fw fa-gratipay"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://gitee.com/cononyc" title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;cononyc" rel="noopener" target="_blank"><i class="fa fa-fw fa-user-circle"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://beian.miit.gov.cn/" rel="noopener" target="_blank">蜀ICP备2021018575号 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">C.c</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
